# Copyright (c) 2022-2026, The Isaac Lab Project Developers (https://github.com/isaac-sim/IsaacLab/blob/main/CONTRIBUTORS.md).
# All rights reserved.
#
# SPDX-License-Identifier: BSD-3-Clause

# Stable SB3 configuration - prevents 40M crash with normalization
seed: 42

# 1000 iterations * 32 steps * 4096 envs = 131072000
n_timesteps: 131072000
policy: 'MlpPolicy'

# Balanced rollout settings
n_steps: 32
# batch_size: 4096 envs * 32 steps / 8 minibatches = 16384
batch_size: 16384

gae_lambda: 0.95
gamma: 0.99

n_epochs: 5

# Small entropy for some exploration but smooth motion
ent_coef: 0.002

# Strong value function
vf_coef: 1.0

learning_rate: !!float 1e-4

clip_range: 0.2
target_kl: 0.01
max_grad_norm: 1.0

# Network architecture
policy_kwargs:
  activation_fn: 'nn.ELU'
  net_arch:
    pi: [256, 128, 64]
    vf: [256, 128, 64]

# CRITICAL: Enable BOTH normalizations to prevent reward collapse
normalize_input: True
normalize_value: True
clip_obs: 10.0
